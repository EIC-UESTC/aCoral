# aCoral C语言代码规范


| 版本 | 作者           | 日期       | 更新内容         |
| ------ | ---------------- | ------------ | ------------------ |
| v0.1 | 饶洪江、文佳源 | 2025-03-18 | 目的、原则、命名 |

## 目的

我们制定该规范的目的旨在提升代码质量、可维护性、协作效率、可移植性、安全性、可靠性，规范编码风格，确保代码清晰、易读、易维护，便于开发者理解和修改他人代码，便于知识传递。如果在团队运作中认为某个规则无法遵循，希望可以共同改进该规则。

## 原则

代码需要在保证功能正确的前提下，满足规范的编码要求。

## 1 命名

命名包括文件、函数、变量、类型、宏等命名。

整体采用unix风格，即单词小写，用下划线分割， 如：'test_result'。

### 1.1 标识符命名风格：


| 类型                                                                                     | 命名风格           |
| ------------------------------------------------------------------------------------------ | -------------------- |
| 函数，结构体类型，枚举类型，联合体类型变量，函数参数，宏参数，结构体中字段，联合体中成员 | 全小写，下划线分割 |
| 宏，常量，枚举值                                                                         | 全大写，下划线分割 |

**注意 1：** 对于单词的缩写，仅可使用约定俗成、被广泛使用的缩写，请勿随意自行进行缩写。不清楚该单词是否有惯用缩写时，使用完整单词。

**注意 2：** 与内核相关的函数名、类型、全局变量前需要加`acoral_`前缀。例：`acoral_ipc_sys_init`, `acoral_u8`, `acoral_ready_queues`

### 1.2 文件命名

文件名应尽量简短、准确、无二义性。

文件名命名只允许使用小写字母、数字以及下划线(_)。

好的命名举例：

`lwip_tcp_client.c`

### 1.3 函数命名

函数的命名遵循一般阅读习惯，动作类函数名，可以使用动宾或者主谓结构；

例：`acoral_mem_scan`, `acoral_get_ticks`

判断型函数，可以用形容词，或加 is。

例：`is_connected`, `data_ready`

### 1.4 变量命名

**除计数变量，所有变量命名均应该能够表达其含义、作用。**

变量命名使用unix风格，包括全局变量，局部变量，函数声明或定义中的参数，带括号宏中的参数。

与内核无关的全局变量需要增加`g_`前缀，与内核相关的全局变量需要增加`acoral_`前缀

函数局部变量的命名，在能够表达相关含义的前提下，应该尽量简短。

### 1.5 类型命名

定义结构体、联合体、枚举时均使用typedef，尽量使用匿名类型。

```c
typedef struct{
    acoral_u8 prio;优先级
    acoral_queue_t stack;局部资源系统栈
    acoral_queue_t wait;
}acoral_mpcp_system_t;

/* 特殊情况例外：必须加_acoral_mq_message */
typedef struct _acoral_mq_message
{
    struct _acoral_mq_message *next;
    acoral_size length;
}acoral_mq_message;
```

### 1.6 宏、常量、枚举命名

全大写，下划线分割
